================================================================================
MEOWDISH NETCODE MIGRATION - QUICK START GUIDE
================================================================================

READ THESE FILES IN ORDER:
1. NETCODE_README.md (5 min) - Overview and index
2. NETCODE_ANALYSIS_SUMMARY.md (15 min) - Executive summary
3. NETCODE_DETAILED_ANALYSIS.md (1 hour) - Deep dive into issues
4. NETCODE_IMPLEMENTATION_TEMPLATES.md (1 hour) - Code templates

================================================================================
3 CRITICAL ISSUES TO UNDERSTAND:
================================================================================

ISSUE #1: ITEM IDs DESYNC (Line 89 in ContainerSystem.cs)
  Current: private int _nextItemID = 1;
  Problem: Different on each client = network desync
  Fix: Server generates IDs, broadcasts to clients

ISSUE #2: INPUT HANDLING (Lines 46-83 in PlayerInputSystem.cs)
  Current: Input.GetKey() → PlayerInputComponent → Applied everywhere
  Problem: Can't distinguish "my input" from "remote player"
  Fix: LocalInputGatherSystem + NetworkOwner check

ISSUE #3: GAMEOBJECT VISUALS (Lines 17-88 in ItemVisualSystem.cs)
  Current: GameObject.CreatePrimitive() in ECS system
  Problem: GameObjects can't replicate across network
  Fix: Graphics.DrawMesh() for pure ECS rendering

================================================================================
MIGRATION TIMELINE:
================================================================================

Week 1 (15 hrs)   → Foundation: Create NetworkOwner/NetworkEntity
Week 2-3 (20 hrs) → Input/Movement: Refactor player systems
Week 3-4 (20 hrs) → CRITICAL: Item system with server IDs
Week 4-5 (24 hrs) → Rendering: Pure ECS graphics
Week 5-6 (24 hrs) → Interactions: Server authority
Week 6-7 (30 hrs) → Testing: Unit tests, integration tests

TOTAL: 153 hours (6-8 weeks for 1 developer)

================================================================================
IMPLEMENTATION CHECKLIST (Phase 1):
================================================================================

Week 1 - Foundation Phase:

[ ] Read NETCODE_README.md
[ ] Read NETCODE_ANALYSIS_SUMMARY.md
[ ] Review NETCODE_ARCHITECTURE_COMPARISON.md
[ ] Create new file: Assets/Scripts/ECS/Components/Network/NetworkOwner.cs
    └─ Copy from NETCODE_IMPLEMENTATION_TEMPLATES.md
[ ] Create new file: Assets/Scripts/ECS/Components/Network/NetworkEntity.cs
    └─ Copy from NETCODE_IMPLEMENTATION_TEMPLATES.md
[ ] Create new file: Assets/Scripts/ECS/Components/Network/LocalPlayerTag.cs
[ ] Update PlayerAuthoring.cs - Add NetworkOwner component
[ ] Test: Run game in single-player, verify still works
[ ] Create git branch: feature/netcode-foundation
[ ] Commit with message: "Phase 1: Network foundation components"

THEN MOVE TO PHASE 2:

[ ] Read: NETCODE_DETAILED_ANALYSIS.md section "PlayerMovementSystem"
[ ] Read: NETCODE_IMPLEMENTATION_TEMPLATES.md "PlayerMovementSystem → Add Owner Check"
[ ] Update PlayerMovementSystem.cs:
    └─ Add NetworkOwner to RequireForUpdate
    └─ Add NetworkOwner to Query
    └─ Test movement system still works
[ ] Create new: LocalInputGatherSystem.cs
    └─ Copy template from NETCODE_IMPLEMENTATION_TEMPLATES.md
[ ] Update PlayerInputSystem.cs (reduce scope)
[ ] Test: Input gathering works for local player
[ ] Commit: "Phase 2: Owner-only movement and input separation"

THEN MOVE TO PHASE 3 (CRITICAL):

[ ] Create: ServerItemAuthority.cs (server-only)
[ ] Create: ClientItemSync.cs (client-only)
[ ] Create: TakeItemRequestRpc struct
[ ] Create: ItemCreatedEvent struct
[ ] Refactor: ContainerSystem.cs - remove item creation
[ ] Test: Item creation synchronized across clients
[ ] Commit: "Phase 3: Server-authoritative item system"

================================================================================
KEY FILES TO MODIFY:
================================================================================

Primary systems (in order):
1. /Assets/Scripts/ECS/Systems/Player/PlayerMovementSystem.cs (12 hrs)
2. /Assets/Scripts/ECS/Systems/Player/PlayerInputSystem.cs (20 hrs)
3. /Assets/Scripts/ECS/Systems/Interaction/ContainerSystem.cs (20 hrs)
4. /Assets/Scripts/ECS/Systems/Interaction/InteractionSystem.cs (24 hrs)
5. /Assets/Scripts/ECS/Systems/Visual/ItemVisualSystem.cs (24 hrs)

Supporting authoring:
- /Assets/Scripts/ECS/Authoring/PlayerAuthoring.cs

New files to create:
- Network components directory
- Authority systems (server-only)
- Sync systems (client-only)
- RPC command definitions
- Event structures

================================================================================
TESTING REQUIREMENTS:
================================================================================

After Each Phase:
✓ Single-player still works
✓ No compilation errors
✓ No NetCode-specific errors
✓ Git clean commit

Phase 3 Validation (Critical):
✓ 2 local clients spawned
✓ Player A picks up item → All clients see ID=X
✓ Player B picks up item → All clients see ID=X+1
✓ Items don't desync

Final Integration:
✓ Full 2-client + server test
✓ Prediction/rollback works
✓ No ghost player glitching
✓ Performance acceptable

================================================================================
DOCUMENTATION REFERENCE:
================================================================================

For ANY question, find the answer in:

Conceptual:       → NETCODE_ANALYSIS_SUMMARY.md
Architecture:     → NETCODE_ARCHITECTURE_COMPARISON.md
Deep Technical:   → NETCODE_DETAILED_ANALYSIS.md
Code Examples:    → NETCODE_IMPLEMENTATION_TEMPLATES.md

All documents have:
- Issue description (what's wrong)
- Why it's a problem (NetCode incompatibility)
- Detailed solution (how to fix it)
- Line numbers (where to implement)
- Code examples (copy-paste ready)

================================================================================
COMMON GOTCHAS:
================================================================================

1. Entity References won't sync
   - Problem: CurrentStationEntity references local Entity IDs
   - Solution: Use NetworkEntity.NetworkID instead
   - Reference: NETCODE_DETAILED_ANALYSIS.md "Component Analysis"

2. Input-based animation breaks on ghost players
   - Problem: Ghosts don't have "real" input, show no animation
   - Solution: Base animation on movement delta not input
   - Reference: NETCODE_DETAILED_ANALYSIS.md "PlayerAnimationSystem"

3. GameObject.Find() causes issues
   - Problem: Slow and unreliable, doesn't work in networked context
   - Solution: Use dependency injection or FindObjectOfType with caching
   - Reference: NETCODE_IMPLEMENTATION_TEMPLATES.md "Issue 1"

4. Burst compilation requirement
   - Problem: Systems must be BurstCompile-compatible for NetCode
   - Solution: Use ISystem struct, not SystemBase class
   - Reference: NETCODE_DETAILED_ANALYSIS.md "PlayerInputSystem"

5. Item ID generation
   - Problem: Each client increments counter independently
   - Solution: Let server generate IDs, broadcast to all
   - Reference: NETCODE_DETAILED_ANALYSIS.md "ContainerSystem" (CRITICAL)

================================================================================
SUCCESS METRICS:
================================================================================

Phase 1 Complete:  Network components exist, single-player works
Phase 2 Complete:  Movement is owner-only, input separated
Phase 3 Complete:  Item IDs synchronized across all clients
Phase 4 Complete:  Pure ECS rendering, no GameObjects
Phase 5 Complete:  Interactions server-authoritative
Phase 6 Complete:  All tests passing, 2+ players can play together

================================================================================
RESOURCES:
================================================================================

Unity NetCode Documentation:
  https://docs.unity.com/netcode/current/content/getting-started.html

DOTS ECS Documentation:
  https://docs.unity3d.com/Packages/com.unity.entities/current

Burst Compilation:
  https://docs.unity3d.com/Packages/com.unity.burst/current

All needed information is in the 5 analysis documents.
No external learning required - templates provided.

================================================================================

Questions? Check the detailed analysis documents.
Ready to start? Begin with Phase 1 Foundation (Week 1).

Good luck with your multiplayer implementation!

